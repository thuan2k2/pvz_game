<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PvZ: Origins</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Cinzel:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css"> 
    
    <style>
        /* --- HEX TECH THEME --- */
        :root {
            --lol-dark-blue: #010a13;
            --lol-panel-bg: rgba(1, 10, 19, 0.9);
            --lol-gold: #c8aa6e;
            --lol-gold-dim: #785a28;
            --lol-blue-bright: #005a82;
            --lol-cyan: #0acbe6;
            --lol-text-grey: #a09b8c;
            --lol-border: 1px solid #3c3c41;
        }

        body {
            margin: 0; padding: 0;
            background-color: #000;
            font-family: 'Roboto', sans-serif;
            overflow: hidden;
            color: #f0e6d2;
            user-select: none;
        }

        .hidden { display: none !important; }

        /* --- NOTIFICATION BAR --- */
        #notification-bar {
            position: fixed; top: 0; left: 0; width: 100%; height: 30px;
            background: rgba(16, 20, 25, 0.95); border-bottom: 1px solid var(--lol-gold);
            color: var(--lol-gold); z-index: 9999; display: none; align-items: center; white-space: nowrap;
        }
        #notification-text { display: inline-block; padding-left: 100%; animation: marquee 20s linear infinite; font-size: 12px; font-weight: bold; letter-spacing: 1px;}
        @keyframes marquee { 0% { transform: translateX(0); } 100% { transform: translateX(-100%); } }

        /* --- GAME CONTAINER --- */
        #game-canvas { background: #000; display: block; margin: 0 auto; }

        /* --- LOBBY SCREEN (STYLE LOL) --- */
        #lobby-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: url('https://w.wallhaven.cc/full/0q/wallhaven-0qpw3l.jpg') no-repeat center center/cover;
            z-index: 100;
            display: flex; flex-direction: column;
        }
        
        /* 1. TOP NAV BAR (FIX L·ªñI CANH GI·ªÆA) */
        .lol-top-nav {
            height: 80px; width: 100%; /* ƒê·∫£m b·∫£o full width */
            background: linear-gradient(to bottom, #1e2328, #0a0c10);
            border-bottom: 2px solid var(--lol-gold-dim);
            display: flex; justify-content: space-between; align-items: center;
            padding: 0 30px; box-sizing: border-box; /* Padding kh√¥ng l√†m v·ª° width */
            box-shadow: 0 5px 20px rgba(0,0,0,0.8);
            position: relative; z-index: 10;
        }

        .nav-left { display: flex; align-items: center; gap: 40px; }
        .lol-logo-text {
            font-family: 'Cinzel', serif; font-size: 24px; color: var(--lol-gold);
            text-shadow: 0 0 10px rgba(200, 170, 110, 0.5);
            font-weight: bold; letter-spacing: 2px;
            cursor: default;
            margin-right: 20px;
        }
        
        .lol-menu-item {
            font-size: 14px; font-weight: bold; text-transform: uppercase;
            color: var(--lol-text-grey); cursor: pointer;
            letter-spacing: 1.5px; transition: 0.3s;
            position: relative; height: 80px; line-height: 80px; /* Canh gi·ªØa theo chi·ªÅu d·ªçc */
        }
        .lol-menu-item:hover, .lol-menu-item.active { color: #f0e6d2; text-shadow: 0 0 8px rgba(240, 230, 210, 0.6); }
        .lol-menu-item.active::after {
            content: ''; position: absolute; bottom: 0; left: 50%; transform: translateX(-50%);
            width: 0; height: 0; border-left: 10px solid transparent; border-right: 10px solid transparent;
            border-bottom: 10px solid var(--lol-gold);
        }

        .nav-right { display: flex; align-items: center; gap: 25px; }
        
        .currency-container { display: flex; gap: 20px; font-size: 13px; color: #f0e6d2; margin-right: 20px;}
        .currency-item { display: flex; align-items: center; gap: 5px; font-weight: bold;}
        
        .user-profile-mini { display: flex; align-items: center; gap: 15px; cursor: pointer; }
        .profile-name { text-align: right; }
        .profile-name div:first-child { font-weight: bold; color: #f0e6d2; font-size: 15px; }
        .profile-name div:last-child { font-size: 12px; color: var(--lol-cyan); margin-top: 2px; }
        .avatar-circle {
            width: 50px; height: 50px; border-radius: 50%;
            border: 2px solid var(--lol-gold);
            background: url('assets/card/Peashooter.png') no-repeat center/cover;
            background-color: #000;
            box-shadow: 0 0 10px var(--lol-gold);
        }

        /* 2. MAIN CONTENT AREA (FIX LAYOUT) */
        .lol-main-content { 
            flex: 1; display: flex; position: relative; 
            overflow: hidden; /* Tr√°nh thanh cu·ªôn th·ª´a */
        }

        .featured-banner {
            flex: 1; 
            /* X√≥a margin c·ª©ng ƒë·ªÉ banner tr√†n m√†n h√¨nh b√™n tr√°i */
            margin: 0; 
            position: relative;
            display: flex; flex-direction: column; justify-content: flex-end;
            padding: 40px; /* Padding n·ªôi dung b√™n trong */
        }
        
        /* FIX DANH S√ÅCH B·∫†N B√à (SOCIAL SIDEBAR) */
        .lol-social-sidebar {
            width: 280px; 
            background: rgba(1, 10, 19, 0.95);
            border-left: 2px solid #1e2328;
            /* Neo v√†o b√™n ph·∫£i */
            position: relative; 
            right: 0; top: 0; bottom: 0;
            display: flex; flex-direction: column;
            padding: 15px;
            z-index: 5;
        }
        .social-header { 
            font-size: 13px; font-weight: bold; color: var(--lol-text-grey); 
            margin-bottom: 15px; text-transform: uppercase; letter-spacing: 1px;
        }
        .friend-item {
            display: flex; align-items: center; gap: 10px; padding: 10px;
            transition: 0.2s; cursor: pointer; border-radius: 4px;
        }
        .friend-item:hover { background: rgba(255,255,255,0.05); }
        .friend-avatar { width: 35px; height: 35px; border-radius: 50%; border: 1px solid var(--lol-gold); }
        .friend-info { font-size: 13px; color: #cdbe91; font-weight: 500; }
        .friend-status { font-size: 11px; color: var(--lol-cyan); }

        /* FIX V·ªä TR√ç N√öT PLAY & H∆Ø·ªöNG D·∫™N */
        .lol-action-area {
            /* Neo tuy·ªát ƒë·ªëi v√†o g√≥c d∆∞·ªõi b√™n ph·∫£i c·ªßa banner (tr∆∞·ªõc sidebar) */
            position: absolute; 
            bottom: 50px; 
            right: 320px; /* C√°ch sidebar (280px) + kho·∫£ng ƒë·ªám */
            display: flex; gap: 20px; align-items: flex-end;
            z-index: 20;
        }

        /* N√öT PLAY ƒê·∫∂C TR∆ØNG */
        .lol-play-btn {
            background: linear-gradient(to bottom, #1e2328, #13171d);
            border: 2px solid var(--lol-blue-bright);
            color: #f0e6d2;
            font-family: 'Cinzel', serif;
            font-size: 24px; font-weight: bold; letter-spacing: 2px;
            padding: 15px 60px; /* To h∆°n */
            cursor: pointer;
            position: relative;
            box-shadow: 0 0 20px rgba(0, 90, 130, 0.6);
            transition: 0.3s;
            text-transform: uppercase;
            /* T·∫°o h√¨nh b√¨nh h√†nh nh·∫π n·∫øu mu·ªën gi·ªëng LoL h∆°n */
            transform: skew(-10deg); 
        }
        /* Ch·ªânh l·∫°i text b√™n trong n√∫t do skew */
        .lol-play-btn span { display: block; transform: skew(10deg); }
        
        .lol-play-btn:hover:not(:disabled) {
            background: linear-gradient(to bottom, #005a82, #004260);
            border-color: var(--lol-cyan);
            text-shadow: 0 0 10px #fff;
            box-shadow: 0 0 30px var(--lol-cyan);
        }
        
        .lol-play-btn:disabled { 
            filter: grayscale(1); opacity: 0.6; cursor: not-allowed; 
            border-color: #333;
        }

        /* N√∫t ph·ª• (H∆∞·ªõng d·∫´n) - FIX L·ªñI T√ÄNG H√åNH */
        .lol-sub-btn {
            background: rgba(1, 10, 19, 0.8); /* Th√™m m√†u n·ªÅn */
            border: 1px solid var(--lol-gold-dim);
            color: var(--lol-gold); 
            padding: 12px 30px;
            font-weight: bold; cursor: pointer; transition: 0.2s;
            font-size: 14px; text-transform: uppercase; letter-spacing: 1px;
            /* T·∫°o h√¨nh b√¨nh h√†nh */
            transform: skew(-10deg);
        }
        .lol-sub-btn span { display: block; transform: skew(10deg); }

        .lol-sub-btn:hover { 
            border-color: #f0e6d2; color: #f0e6d2; 
            background: rgba(200, 170, 110, 0.2); 
            box-shadow: 0 0 10px rgba(200, 170, 110, 0.3);
        }

        /* --- MODALS --- */
        .modal { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.8); z-index: 2000; 
            display: flex; justify-content: center; align-items: center; 
            backdrop-filter: blur(5px);
        }
        .modal-content {
            background: #010a13; border: 2px solid var(--lol-gold);
            padding: 30px; width: 400px; text-align: center;
            box-shadow: 0 0 30px rgba(200, 170, 110, 0.2);
            color: #f0e6d2;
        }
        .auth-choice-btn {
            width: 100%; padding: 12px; margin: 8px 0;
            background: #1e2328; border: 1px solid #3c3c41; color: #f0e6d2;
            cursor: pointer; transition: 0.2s; text-transform: uppercase; letter-spacing: 1px;
        }
        .auth-choice-btn:hover { border-color: var(--lol-gold); background: #252a33; }

        .shovel-corner, #game-header { display: none; }
        body.in-game .shovel-corner { display: block; }
        body.in-game #game-header { display: flex; }
        body.in-game #lobby-screen { display: none; }

    </style>
</head>
<body>

    <div id="notification-bar">
        <span id="notification-text">üì¢ Welcome to PvZ: Origins - Open Beta...</span>
    </div>

    <div id="data-error-popup" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 10000; justify-content: center; align-items: center; text-align: center; color: white;">
        <div style="background: #1e2328; padding: 40px; border: 2px solid #c0392b; max-width: 500px;">
            <h1 style="margin: 0 0 20px 0; color:#c0392b">‚ö†Ô∏è SYSTEM ERROR</h1>
            <p>Admin data not found (Plants/Zombies).</p>
            <button onclick="location.reload()" class="lol-sub-btn" style="margin-top:20px;"><span>RECONNECT</span></button>
            <div style="margin-top:15px;"><a href="login.html" style="color:#aaa; font-size:12px;">Admin Login</a></div>
        </div>
    </div>

    <div id="lobby-screen">
        <div class="lol-top-nav">
            <div class="nav-left">
                <div class="lol-logo-text">PvZ: ORIGINS</div>
                <div class="lol-menu-item active">TRANG CH·ª¶</div>
                <div class="lol-menu-item" onclick="window.location.href='shop.html'">C·ª¨A H√ÄNG</div>
                <div class="lol-menu-item hidden" id="btn-admin-nav" onclick="window.location.href='admin.html'">QU·∫¢N TR·ªä</div>
            </div>
            
            <div class="nav-right">
                <div class="currency-container hidden" id="lobby-balance-container">
                    <div class="currency-item"><span style="color:#f0e6d2">üí∞</span><span id="lobby-coin">0</span></div>
                    <div class="currency-item"><span style="color:#f0e6d2">üü°</span><span id="lobby-vncoin">0</span></div>
                </div>
                <div class="user-profile-mini" id="btn-open-auth-menu">
                    <div class="profile-name">
                        <div id="lobby-username">Kh√°ch</div>
                        <div id="lobby-status">Tr·ª±c tuy·∫øn</div>
                    </div>
                    <div class="avatar-circle"></div>
                </div>
                <div id="btn-lobby-logout" class="hidden" style="cursor:pointer; font-size:18px;" title="ƒêƒÉng xu·∫•t">üö™</div>
            </div>
        </div>

        <div class="lol-main-content">
            <div class="featured-banner">
                <div style="position: absolute; top: 15%; left: 5%; color: white; text-shadow: 0 0 10px black; width: 400px;">
                    <h3 style="color:var(--lol-gold); font-size:14px; letter-spacing:2px; margin-bottom:5px;">S·ª∞ KI·ªÜN M·ªöI</h3>
                    <h1 style="font-family: 'Cinzel', serif; font-size: 48px; margin: 0; color: #fff; line-height: 1.1;">TH·ª®C T·ªàNH<br>WALL-NUT</h1>
                    <p style="color: #a09b8c; margin-top: 15px; font-size: 14px; line-height: 1.5;">
                        Tham gia ngay ch·∫ø ƒë·ªô phi√™u l∆∞u ƒë·ªÉ nh·∫≠n trang ph·ª•c Wall-nut Ho√†ng Kim gi·ªõi h·∫°n v√† h√†ng ng√†n ph·∫ßn qu√† h·∫•p d·∫´n.
                    </p>
                </div>
            </div>

            <div class="lol-action-area">
                <button class="lol-sub-btn" id="btn-tutorial"><span>H∆Ø·ªöNG D·∫™N</span></button>
                <button id="btn-start-game" class="lol-play-btn" disabled><span>ƒê·∫§U NGAY</span></button>
            </div>

            <div class="lol-social-sidebar">
                <div class="social-header">DANH S√ÅCH B·∫†N B√à (0/0)</div>
                <div style="flex:1; display:flex; justify-content:center; align-items:center; color:#555; font-size:12px; font-style:italic;">
                    Ch∆∞a c√≥ b·∫°n b√® online
                </div>
                </div>
        </div>
    </div>

    <div id="game-header" style="position:fixed; top:0; right:0; z-index:90; padding:10px; display:none;">
        <div class="header-actions">
            <button id="btn-pause-game" class="lol-sub-btn" style="background:rgba(0,0,0,0.8); transform:none;"><span>‚è∏ MENU</span></button>
        </div>
    </div>

    <div id="game-container">
        <canvas id="game-canvas"></canvas>
        <div id="game-hud">
            <div class="hud-item sun-display" style="position:absolute; top:10px; left:10px; font-size:20px; color:white; font-weight:bold; text-shadow:2px 2px 0 #000;">‚òÄÔ∏è <span id="sun-count">0</span></div>
            <div class="hud-item score-display" style="position:absolute; top:40px; left:10px; font-size:20px; color:gold; font-weight:bold; text-shadow:2px 2px 0 #000;">üèÜ <span id="score-count">0</span></div>
        </div>
        <div id="shovel-tool" class="shovel-corner" title="D√πng x·∫ªng ƒë·ªÉ b·ªè c√¢y" style="position:absolute; top:10px; right:120px; cursor:pointer;">
            <img src="assets/shovel.png" alt="Shovel" style="width:50px; background:rgba(0,0,0,0.5); border-radius:5px; border:2px solid #fff;">
        </div>
    </div>

    <div id="bottom-toolbar" class="hidden" style="position:fixed; bottom:0; left:50%; transform:translateX(-50%); background:rgba(0,0,0,0.8); padding:10px; border-top:2px solid var(--lol-gold); border-radius:10px 10px 0 0; display:flex; align-items:center;">
        <div class="toolbar-inner" style="display:flex;">
            <div id="plant-shop-bar"></div>
            <div id="plant-food-tool" style="margin-left: 20px; background: #2ecc71; color: white; display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer; border: 2px solid #27ae60; border-radius: 5px; width: 60px; height: 70px;" title="Thu·ªëc TƒÉng L·ª±c">
                <span style="font-size: 24px;">üçÉ</span>
                <span id="plant-food-count" style="font-size: 14px; font-weight: bold;">0</span>
            </div>
        </div>
    </div>

    <div id="modal-pause-menu" class="modal hidden">
        <div class="modal-content">
            <h2 style="color:var(--lol-gold);">T·∫†M D·ª™NG</h2>
            <button id="btn-resume" class="lol-sub-btn" style="width:100%; margin:5px 0; transform:none;"><span>TI·∫æP T·ª§C</span></button>
            <button id="btn-restart-pause" class="lol-sub-btn" style="width:100%; margin:5px 0; transform:none;"><span>CH∆†I L·∫†I</span></button>
            <button id="btn-quit-lobby" class="lol-sub-btn" style="width:100%; margin:5px 0; border-color:#c0392b; color:#c0392b; transform:none;"><span>THO√ÅT TR·∫¨N</span></button>
        </div>
    </div>

    <div id="overlay-screen" class="hidden">
        <div class="modal" style="background:rgba(0,0,0,0.9);">
            <div class="modal-content" style="border-color:var(--lol-cyan);">
                <h1 id="result-title" style="color:var(--lol-cyan);">CHI·∫æN TH·∫ÆNG</h1>
                <div style="margin:20px 0;">
                    <p>ƒêi·ªÉm: <span id="final-score" style="color:white; font-weight:bold;">0</span></p>
                    <p id="reward-section">Th∆∞·ªüng: <span id="reward-coin" style="color:gold;">0</span> Coin</p>
                </div>
                <button id="btn-restart" class="lol-sub-btn" style="transform:none;"><span>CH∆†I L·∫†I</span></button>
                <button id="btn-back-lobby" class="lol-sub-btn" style="transform:none;"><span>V·ªÄ S·∫¢NH</span></button>
            </div>
        </div>
    </div>

    <div id="modal-auth-selection" class="modal hidden">
        <div class="modal-content">
            <h2 style="color: var(--lol-gold); margin-bottom: 20px; font-family:'Cinzel', serif;">LOGIN</h2>
            <button class="auth-choice-btn" onclick="window.location.href='login.html'">T√ÄI KHO·∫¢N (Email)</button>
            <button class="auth-choice-btn" onclick="window.location.href='register.html'">T·∫†O T√ÄI KHO·∫¢N</button>
            <div style="margin:15px 0; height:1px; background:#333;"></div>
            <button id="btn-play-guest" class="auth-choice-btn" style="border-color:#f1c40f; color:#f1c40f;">CH·∫æ ƒê·ªò KH√ÅCH</button>
            <button class="lol-sub-btn" onclick="closeModal('modal-auth-selection')" style="margin-top: 20px; border:none; transform:none;"><span>ƒê√≥ng</span></button>
        </div>
    </div>

    <div id="modal-tutorial" class="modal hidden">
        <div class="modal-content" style="width:600px; text-align:left;">
            <h2 style="color:var(--lol-gold); text-align:center;">H∆Ø·ªöNG D·∫™N T√ÇN TH·ª¶</h2>
            <ul style="color: #a09b8c; line-height:1.8;">
                <li>üåª <b>H∆∞·ªõng D∆∞∆°ng:</b> T·∫°o ra nƒÉng l∆∞·ª£ng m·∫∑t tr·ªùi.</li>
                <li>üå± <b>B·∫Øn ƒê·∫≠u:</b> ƒê∆°n v·ªã t·∫•n c√¥ng c∆° b·∫£n.</li>
                <li>ü•î <b>C·ªß Khoai:</b> ƒê∆°n v·ªã ph√≤ng th·ªß ch·ªãu ƒë√≤n.</li>
                <li>üçÉ <b>Thu·ªëc TƒÉng L·ª±c:</b> D√πng trong Shop ƒë·ªÉ k√≠ch ho·∫°t k·ªπ nƒÉng t·ªëi th∆∞·ª£ng.</li>
            </ul>
            <div style="text-align:center; margin-top:20px;">
                <button class="lol-sub-btn" onclick="closeModal('modal-tutorial')" style="transform:none;"><span>ƒê√É HI·ªÇU</span></button>
            </div>
        </div>
    </div>

    <script type="module" src="src/main.js"></script>
    
    <script>
        function closeModal(id) {
            document.getElementById(id).classList.add('hidden');
        }
    </script>
</body>
</html>